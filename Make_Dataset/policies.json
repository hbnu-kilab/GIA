{
    "version": "1.1",
    "defaults": {
        "scenarios": [
            "보안 설정 점검",
            "라우팅 구성 검증",
            "VRF/RT 구성 확인",
            "L2VPN 일관성 확인",
            "OSPF 영역/이웃 가시성 확인",
            "시스템/접속 기본 정보 점검",
            "명령어 사용/생성 학습"
        ],
        "min_per_category": 15
    },
    "policies": [
        {
            "category": "Security_Policy",
            "levels": {
                "1": [
                    {
                        "goal": "validity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ssh_enabled_devices"
                    },
                    {
                        "goal": "visibility",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "aaa_enabled_devices"
                    }
                ],
                "2": [
                    {
                        "goal": "completeness",
                        "targets": [
                            "GLOBAL"
                        ],
                        "primary_metric": "ssh_missing_devices"
                    },
                    {
                        "goal": "compliance",
                        "targets": [
                            "GLOBAL"
                        ],
                        "conditions": {
                            "ssh.present": true
                        }
                    }
                ]
            }
        },
        {
            "category": "BGP_Consistency",
            "levels": {
                "1": [
                    {
                        "goal": "visibility",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "neighbor_list_ibgp"
                    }
                ],
                "2": [
                    {
                        "goal": "consistency",
                        "targets": [
                            "AS"
                        ],
                        "primary_metric": "ibgp_missing_pairs"
                    },
                    {
                        "goal": "completeness",
                        "targets": [
                            "AS"
                        ]
                    }
                ]
            }
        },
        {
            "category": "VRF_Consistency",
            "levels": {
                "1": [
                    {
                        "goal": "visibility",
                        "targets": [
                            "VRF"
                        ],
                        "primary_metric": "vrf_rd_map"
                    }
                ],
                "2": [
                    {
                        "goal": "completeness",
                        "targets": [
                            "GLOBAL"
                        ],
                        "primary_metric": "vrf_without_rt_pairs"
                    },
                    {
                        "goal": "consistency",
                        "targets": [
                            "DEVICE_VRF"
                        ]
                    }
                ]
            }
        },
        {
            "category": "L2VPN_Consistency",
            "levels": {
                "1": [
                    {
                        "goal": "visibility",
                        "targets": [
                            "GLOBAL"
                        ],
                        "primary_metric": "l2vpn_pairs"
                    }
                ],
                "2": [
                    {
                        "goal": "consistency",
                        "targets": [
                            "GLOBAL"
                        ],
                        "primary_metric": "l2vpn_unidirectional_pairs"
                    }
                ]
            }
        },
        {
            "category": "OSPF_Consistency",
            "levels": {
                "1": [
                    {
                        "goal": "visibility",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ospf_area0_if_list"
                    }
                ],
                "2": [
                    {
                        "goal": "consistency",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ospf_area0_if_count"
                    }
                ]
            }
        },
        {
            "category": "System_Inventory",
            "levels": {
                "1": [
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "system_hostname_text"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "system_version_text"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "system_user_count"
                    }
                ]
            }
        },
        {
            "category": "Security_Inventory",
            "levels": {
                "1": [
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ssh_present_bool"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ssh_version_text"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "aaa_present_bool"
                    }
                ]
            }
        },
        {
            "category": "Interface_Inventory",
            "levels": {
                "1": [
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "interface_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "interface_ip_map"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "vrf_bind_map"
                    }
                ]
            }
        },
        {
            "category": "Routing_Inventory",
            "levels": {
                "1": [
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "bgp_local_as_numeric"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "bgp_neighbor_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ospf_process_ids_set"
                    }
                ]
            }
        },
        {
            "category": "Services_Inventory",
            "levels": {
                "1": [
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "vrf_names_set"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "vrf_rd_map"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "mpls_ldp_present_bool"
                    }
                ]
            }
        },
        {
            "category": "Security_Policy",
            "levels": {
                "2": [
                    {
                        "goal": "completeness",
                        "targets": [
                            "GLOBAL"
                        ],
                        "primary_metric": "ssh_missing_count"
                    },
                    {
                        "goal": "compliance",
                        "targets": [
                            "GLOBAL"
                        ],
                        "primary_metric": "aaa_missing_devices"
                    }
                ]
            }
        },
        {
            "category": "BGP_Consistency",
            "levels": {
                "1": [
                    {
                        "goal": "visibility",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "neighbor_list_ebgp"
                    }
                ],
                "2": [
                    {
                        "goal": "consistency",
                        "targets": [
                            "AS"
                        ],
                        "primary_metric": "ibgp_under_peered_devices"
                    }
                ]
            }
        },
        {
            "category": "VRF_Consistency",
            "levels": {
                "1": [
                    {
                        "goal": "visibility",
                        "targets": [
                            "DEVICE_VRF"
                        ],
                        "primary_metric": "vrf_rt_list_per_device"
                    }
                ],
                "2": [
                    {
                        "goal": "consistency",
                        "targets": [
                            "DEVICE_VRF"
                        ],
                        "primary_metric": "vrf_interface_bind_count"
                    },
                    {
                        "goal": "consistency",
                        "targets": [
                            "GLOBAL"
                        ],
                        "primary_metric": "vrf_rd_format_invalid_set"
                    }
                ]
            }
        },
        {
            "category": "L2VPN_Consistency",
            "levels": {
                "2": [
                    {
                        "goal": "consistency",
                        "targets": [
                            "GLOBAL"
                        ],
                        "primary_metric": "l2vpn_pwid_mismatch_pairs"
                    },
                    {
                        "goal": "consistency",
                        "targets": [
                            "GLOBAL"
                        ],
                        "primary_metric": "l2vpn_mismatch_count"
                    },
                    {
                        "goal": "consistency",
                        "targets": [
                            "GLOBAL"
                        ],
                        "primary_metric": "l2vpn_unidir_count"
                    }
                ]
            }
        },
        {
            "category": "OSPF_Consistency",
            "levels": {
                "1": [
                    {
                        "goal": "visibility",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ospf_proc_ids"
                    }
                ]
            }
        },
        {
            "category": "System_Inventory",
            "levels": {
                "1": [
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "system_user_list"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "system_timezone_text"
                    }
                ]
            }
        },
        {
            "category": "Security_Inventory",
            "levels": {
                "1": [
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "password_policy_present_bool"
                    }
                ]
            }
        },
        {
            "category": "Interface_Inventory",
            "levels": {
                "1": [
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "interface_vlan_set"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "subinterface_count"
                    }
                ]
            }
        },
        {
            "category": "Routing_Inventory",
            "levels": {
                "1": [
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ospf_area_set"
                    }
                ]
            }
        },
        {
            "category": "Services_Inventory",
            "levels": {
                "1": [
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "rt_import_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "rt_export_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "vrf_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "l2vpn_pw_id_set"
                    }
                ]
            }
        },
        {
            "category": "Basic_Info",
            "levels": {
                "1": [
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "system_hostname_text"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "system_mgmt_address_text"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "system_version_text"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ios_config_register_text"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "logging_buffered_severity_text"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "http_server_enabled_bool"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ip_forward_protocol_nd_bool"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "ip_cef_enabled_bool"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "vty_first_last_text"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "vty_login_mode_text"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "vty_password_secret_text"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "vty_transport_input_text"
                    },
                    {
                        "goal": "sanity",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "system_users_detail_map"
                    }
                ],
                "2": [
                    {
                        "goal": "interface",
                        "targets": [
                            "DEVICE_IF"
                        ],
                        "primary_metric": "interface_mop_xenabled_bool"
                    }
                ]
            }
        },
        {
            "category": "Command_Generation",
            "levels": {
                "1": [
                    {
                        "goal": "show_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_show_bgp_summary",
                        "notes": "BGP 상태 확인 명령어"
                    },
                    {
                        "goal": "show_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_show_ip_interface_brief",
                        "notes": "인터페이스 상태 확인 명령어"
                    },
                    {
                        "goal": "show_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_show_ip_route_ospf",
                        "notes": "OSPF 라우팅 정보 확인 명령어"
                    },
                    {
                        "goal": "show_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_show_ip_ospf_neighbor",
                        "notes": "OSPF 이웃 상태 확인 명령어"
                    },
                    {
                        "goal": "show_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_show_users",
                        "notes": "접속 사용자 확인 명령어"
                    },
                    {
                        "goal": "show_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_show_logging",
                        "notes": "로그 확인 명령어"
                    }
                ],
                "2": [
                    {
                        "goal": "config_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_set_static_route",
                        "notes": "정적 라우팅 설정 명령어"
                    },
                    {
                        "goal": "config_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_set_bgp_routemap",
                        "notes": "BGP 라우트맵 설정 명령어"
                    },
                    {
                        "goal": "config_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_set_interface_description",
                        "notes": "인터페이스 설명 설정 명령어"
                    },
                    {
                        "goal": "config_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_create_vrf_and_assign",
                        "notes": "VRF 생성 및 할당 명령어"
                    },
                    {
                        "goal": "config_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_set_ospf_cost",
                        "notes": "OSPF 비용 설정 명령어"
                    },
                    {
                        "goal": "config_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_set_vty_acl",
                        "notes": "VTY ACL 설정 명령어"
                    },
                    {
                        "goal": "config_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_set_hostname",
                        "notes": "호스트네임 설정 명령어"
                    },
                    {
                        "goal": "show_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_show_processes_cpu",
                        "notes": "CPU 프로세스 확인 명령어"
                    },
                    {
                        "goal": "show_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_show_l2vpn_vc",
                        "notes": "L2VPN VC 상태 확인 명령어"
                    },
                    {
                        "goal": "ssh_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_ssh_direct_access",
                        "notes": "SSH 직접 접속 명령어"
                    },
                    {
                        "goal": "ssh_commands",
                        "targets": [
                            "DEVICE"
                        ],
                        "primary_metric": "cmd_ssh_proxy_jump",
                        "notes": "SSH 프록시 점프 명령어"
                    }
                ]
            }
        }
    ]
}
