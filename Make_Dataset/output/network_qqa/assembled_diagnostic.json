[
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-001",
    "question": "모든 장비에서 AAA가 활성화되어 있고, 예외 없이 중앙 인증으로 통일되어 있는가? (미준수 장비 식별 및 우선순위 개선 권고 포함)",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": {
      "compliant": false,
      "non_compliant_devices": [
        "CE1"
      ],
      "remediation_priority": [
        {
          "device": "CE1",
          "priority": "High"
        }
      ]
    },
    "explanation": "제공된 증거에서 aaa_present_bool이 ❌로 표시되어 있어 AAA가 활성화되어 있지 않거나 중앙 인증으로 통일되어 있지 않음을 의미합니다. aaa_enabled_devices와 aaa_missing_devices 항목이 None으로 되어 있어 구체적 목록은 없지만 system_hostname_text가 CE1로 보고되어 있으므로 관찰된 장비 CE1이 미준수 장비로 식별됩니다. 따라서 전체 준수 여부는 '아니오'이며, 우선순위는 CE1에 대해 높음(High)으로 설정해야 합니다. 권고 조치로는 CE1에 대해 즉시 AAA를 활성화하고 중앙 인증(RADIUS/TACACS+) 서버 연동을 구성한 뒤, 구성 일관성(템플릿/정책 적용)을 확인하고 다른 장비에 대해서도 인벤토리 점검 및 감사(audit)를 수행하여 동일한 미준수 항목이 없는지 확인하는 것입니다. 변경 전 백업 및 테스트, 변경 후 인증/접속 시나리오 검증 및 모니터링 알림 설정도 병행해야 합니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "compliance_officer",
    "scenario": "정책 준수 점검",
    "source_files": [
      "ce1.xml",
      "ce2.xml",
      "sample10.xml",
      "sample7.xml",
      "sample8.xml",
      "sample9.xml"
    ],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "required_metric": "aaa_enabled_devices",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "aaa_missing_devices",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "aaa_present_bool",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "system_hostname_text",
          "metric_params": {
            "scope": "all_devices"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {
        "step_None_aaa_enabled_devices": null,
        "step_None_aaa_missing_devices": null,
        "step_None_aaa_present_bool": false,
        "step_None_system_hostname_text": "CE1"
      }
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-002",
    "question": "장비들에 대해 패스워드 복잡도·길이·만료 정책이 존재하며, 모든 장비에서 일관되게 적용되고 있는가? 미준수 항목별 개선 권고를 제시하라.",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": "아니오 — 패스워드 복잡도·길이·만료 정책이 존재하지 않으며 모든 장비에 일관되게 적용되고 있지 않습니다.",
    "explanation": "제공된 증거에 따르면 password_policy_present_bool이 ❌로 표시되어 패스워드 정책 자체가 부재하거나 확인되지 않았습니다. 또한 aaa_enabled_devices가 None으로 되어 있어 중앙 인증·권한 부여(AAA)가 활성화되어 있지 않거나 수집되지 않았음을 의미하므로 정책을 전 장비에 일관되게 강제할 수 없는 상태입니다. system_user_count가 0으로 문제없음으로 보고되었지만 이는 로컬 시스템 사용자 수가 없는 것으로 해석될 수 있으며, 오히려 중앙정책 부재를 보완하지 못합니다. 미준수 항목별 개선 권고는 다음과 같습니다. 1) 패스워드 정책 부재: 조직의 비밀번호 보안정책을 문서화하고 최소 요구사항을 정의하십시오(권장 예: 최소 길이 12자, 대문자·소문자·숫자·특수문자 조합, 과거 5개 비밀번호 재사용 금지, 만료 주기 90일 등). 2) 정책 미적용(일관성 결여): 정책을 모든 네트워크 장비에 적용하기 위해 표준 구성 템플릿을 만들고 장비군별(라우터, 스위치, 방화벽 등)로 배포·검증하십시오. 3) AAA 미사용: RADIUS/TACACS+ 등 중앙 인증(AAA)을 도입하여 관리자 계정 및 로그인 정책을 중앙에서 강제하고 로컬 계정 의존을 최소화하십시오. 4) 로컬 계정·예외 관리: 필요 불가피한 로컬 계정은 최소화하고, 서비스 계정은 별도 관리 및 주기적 비밀번호 교체·감사를 시행하십시오. 5) 추가 보완조치: 관리자 접근에 대해 다단계 인증(MFA) 도입을 검토하고, 계정 잠금 정책(예: 실패 5회 시 15분 잠금), 인증·접속 로그 수집 및 정기 감사로 정책 준수 여부를 모니터링하십시오. 6) 실행 절차: 장비 인벤토리 작성 → 정책·템플릿 수립 → 테스트 환경에서 적용 검증 → 단계적 배포 → 배포 후 자동 검사·감사 체계 구축 순으로 시행하십시오. 이러한 조치를 통해 패스워드 관련 보안 정책을 수립하고 모든 장비에 일관되게 적용할 수 있습니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "compliance_officer",
    "scenario": "정책 준수 점검",
    "source_files": [
      "ce1.xml",
      "ce2.xml",
      "sample10.xml",
      "sample7.xml",
      "sample8.xml",
      "sample9.xml"
    ],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "required_metric": "password_policy_present_bool",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "aaa_enabled_devices",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "system_user_count",
          "metric_params": {
            "scope": "all_devices"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {
        "step_None_password_policy_present_bool": false,
        "step_None_aaa_enabled_devices": null,
        "step_None_system_user_count": 0
      }
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-003",
    "question": "각 장비의 로컬 사용자 계정 수가 내부 정책(예: 1~2명 비상계정 허용)을 초과하는가? 초과 장비에 대한 폐기/통제 방안을 제시하라.",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": false,
    "explanation": "CE1의 시스템 정보에서 system_user_count가 0으로 확인되어 내부 정책(비상계정 1~2명 허용)을 초과하지 않습니다. 다만 aaa_present_bool가 '문제'로 표시되어 중앙 인증(AAA)이 구성되어 있지 않거나 제대로 동작하지 않는 것으로 보이므로, 로컬 계정 통제 관점에서 위험요소가 존재합니다. 초과 장비에 대한 일반적인 폐기/통제 방안은 다음과 같습니다. 첫째, 초과 장비 식별 및 분류: 계정 수가 정책을 초과한 장비를 즉시 목록화하고 중요도에 따라 우선순위를 매깁니다. 둘째, 긴급제어 조치: 네트워크 분리 또는 접근제한(VLAN/ACL 적용), 임시 계정 비활성화, 관리자 계정 비밀번호 강제 변경을 시행합니다. 셋째, 계정 정리 및 표준화: 사용되지 않는 로컬 계정을 삭제하고 필요 최소한의 비상계정(1~2명)만 유지하되 계정 소유자와 사용목적을 문서화합니다. 넷째, 중앙인증 도입 및 연동: RADIUS/TACACS+ 등 AAA 서버에 연동하여 로컬 계정 의존을 최소화하고, 인증·권한관리를 중앙에서 통제합니다. 다섯째, 정책·감사·자동화: 계정 생성/변경 시 워크플로우와 승인 절차를 도입하고 정기적인 계정 감사 및 비활성 계정 자동 삭제 규칙을 적용합니다. 여섯째, 모니터링 및 로그관리: 계정 접근 및 인증 실패를 실시간으로 모니터링하고 SIEM에 연동하여 이상행위를 탐지합니다. 마지막으로, 복구 불가능하거나 보안 기준을 만족하지 못하는 장비는 재구성(이미지 재적용)하거나 교체하고, 재발 방지를 위해 구성 관리 도구(CM)로 설정 준수 여부를 자동검증하도록 합니다. CE1의 경우 현재는 계정 수 초과 문제는 없으므로 위 통제 중 중앙인증(AAA) 구성과 로그·모니터링 강화를 우선 권고합니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "compliance_officer",
    "scenario": "정책 준수 점검",
    "source_files": [
      "ce1.xml",
      "ce2.xml",
      "sample10.xml",
      "sample7.xml",
      "sample8.xml",
      "sample9.xml"
    ],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "required_metric": "system_user_count",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "aaa_present_bool",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "system_hostname_text",
          "metric_params": {
            "scope": "all_devices"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {
        "step_None_system_user_count": 0,
        "step_None_aaa_present_bool": false,
        "step_None_system_hostname_text": "CE1"
      }
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-004",
    "question": "모든 장비에서 SSH가 활성화되어 있고, 암호화/프로토콜 버전(권장: SSHv2) 및 관련 설정이 최신 보안 가이드를 따른다는 증거가 있는가? 미준수 장비와 구체적 수정 권고를 제시하라.",
    "context": "보안 설정 현황:\nCE1: SSH ON, AAA OFF\nCE2: SSH ON, AAA OFF\nsample10: SSH ON, AAA ON\nsample7: SSH ON, AAA ON\nsample8: SSH ON, AAA ON",
    "ground_truth": {
      "all_devices_ssh_enabled": true,
      "ssh_protocol_version": 2,
      "ssh_enabled_device_count": 6,
      "non_compliant_devices": []
    },
    "explanation": "제공된 증거에 따르면 ssh_present_bool이 정상(✅)으로 표시되었고 ssh_missing_count가 0이므로 점검 대상 장비들 전체에서 SSH가 활성화되어 있습니다. 또한 ssh_version_text가 '2'로 보고되어 있어 모든 장비가 권장 프로토콜 버전인 SSHv2를 사용하고 있는 것으로 확인됩니다. 따라서 현재 조사된 범위 내에서는 미준수 장비가 존재하지 않습니다. 그럼에도 불구하고 지속적 보안 유지와 방어 심층화를 위해 권장되는 구체적 수정·강화 조치는 다음과 같습니다. (1) SSH 프로토콜을 명시적으로 2로 고정: 네트워크 장비 예: Cisco IOS에서 'ip ssh version 2'를 설정하고 OpenSSH에서는 /etc/ssh/sshd_config에 'Protocol 2' 또는 최신 OpenSSH는 기본값으로 2만 허용하도록 구성합니다. (2) 인증 강제 및 루트 직접 로그인 제한: 패스워드 인증을 비활성화하고 공개키 인증을 사용합니다. OpenSSH 예: 'PasswordAuthentication no' 및 'PubkeyAuthentication yes', 'PermitRootLogin no'. (3) 안전한 키/암호화 알고리즘 사용: 최신 권장 알고리즘(KEX: curve25519-sha256 등, Ciphers: aes256-gcm@openssh.com, chacha20-poly1305@openssh.com 등, MACs: hmac-sha2-512/hmac-sha2-256 등)을 허용하고 약한 알고리즘(RC4, 3DES, hmac-md5 등)을 비활성화합니다. (4) 호스트 키 관리와 키 길이: 호스트 키는 ED25519 또는 최소 3072/4096 RSA를 권장하며 정기적 교체(로테이션) 및 안전한 저장 정책을 시행합니다. (5) 접속 제한 및 타임아웃 구성: 관리 접근을 허용할 IP/네트워크로 제한하는 ACL을 적용하고, 세션 타임아웃을 설정합니다(예: OpenSSH에서 'ClientAliveInterval 300' 및 'ClientAliveCountMax 2' 또는 'LoginGraceTime 60'). (6) 중앙 인증·권한 관리 및 로깅: AAA/TACACS+/RADIUS 연동, SSH 접근 로그 중앙 수집과 모니터링을 구현합니다. (7) 소프트웨어·펌웨어 업데이트 및 구성 관리: SSH 구현의 보안 패치 적용과 구성 변경에 대한 버전관리 및 감사를 실시합니다. (8) 검증 절차: 정기적으로 취약점 스캔 및 구성 감사(예: 자동화 스크립트로 프로토콜/암호화 설정 확인)를 수행합니다. 요약하면, 현재 증거로는 모든 점검 장비가 SSHv2로 활성화되어 있어 미준수 장비는 없으나 위의 구체적 권고들을 적용하여 암호화 알고리즘, 인증 방식, 접근제어, 로깅 및 패치 관리를 강화할 것을 권장합니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "compliance_officer",
    "scenario": "정책 준수 점검",
    "source_files": [
      "ce1.xml",
      "ce2.xml",
      "sample10.xml",
      "sample7.xml",
      "sample8.xml",
      "sample9.xml"
    ],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "required_metric": "ssh_present_bool",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "ssh_enabled_devices",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "ssh_version_text",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "ssh_missing_count",
          "metric_params": {
            "scope": "all_devices"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {
        "step_None_ssh_present_bool": true,
        "step_None_ssh_enabled_devices": [
          "CE1",
          "CE2",
          "sample10",
          "sample7",
          "sample8",
          "sample9"
        ],
        "step_None_ssh_version_text": "2",
        "step_None_ssh_missing_count": 0
      }
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-005",
    "question": "모든 장비의 SSH/VTY 접근에 관리 ACL이 적용되어 있으며, 정책상 허용된 관리망/관리 IP만 허용하는가? 미적용 장비에 대한 표준화·시행 계획을 제시하라.",
    "context": "보안 설정 현황:\nCE1: SSH ON, AAA OFF\nCE2: SSH ON, AAA OFF\nsample10: SSH ON, AAA ON\nsample7: SSH ON, AAA ON\nsample8: SSH ON, AAA ON",
    "ground_truth": "No — management ACLs are not applied to all devices; 6 devices with SSH/VTY enabled are non‑compliant.",
    "explanation": "The automated check 'ssh_acl_applied_check' returned a failure, so the environment is not fully compliant with the policy that only management network/IPs may access device SSH/VTY. The scan shows six devices with SSH enabled (examples reported include CE1, CE2, sample10) that do not have the required management ACL applied. Recommended standardized remediation and enforcement plan: 1) Discovery & inventory: produce a definitive list of the six non‑compliant devices and any other devices with SSH/VTY enabled. 2) Risk mitigation (immediate, within 48 hours): if possible, restrict access via network ACLs or temporary firewall rules to only management IPs or place devices into a management VLAN; disable SSH temporarily only if change control permits. 3) Standard ACL template: define a canonical management ACL (for example, an IPv4/IPv6 ACL that permits management subnets and denies others, applied to VTY lines or SSH transport input), plus exact command snippets and variables (management IP ranges, logging, and rate limits). 4) Staged deployment (1–2 weeks): test the template on lab devices, then deploy to a pilot device, validate connectivity and logging, and confirm rollback procedures. 5) Automated rollout & change control: use an automation tool (Ansible/Netmiko/Config management) to push the approved ACL to all non‑compliant devices with atomic change records; require CAB approval for bulk changes. 6) Verification: after deployment, run verification scripts to confirm ACL presence and VTY behavior (e.g., commands to check vty access, ACL entries, and active sessions) and perform connectivity tests from allowed and denied IPs. 7) Monitoring & alerting: enable logging for management access attempts, configure SIEM alerts for denied/allowed anomalies, and add the ACL compliance check to the regular audit pipeline. 8) Documentation & exceptions: document the change, maintain a justified exceptions process for any device that cannot be modified, and set expiry for exceptions. 9) Enforcement & audit cadence: make the ACL check part of automated daily or weekly compliance scans and require remediation within a defined SLA (e.g., 7 calendar days for medium risk, 48 hours for high risk). 10) Closure: declare remediation complete when automated checks show all devices compliant and evidence of tested access and logging is archived. Following this plan will standardize ACLs across devices and provide ongoing enforcement and verification to meet policy requirements.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "compliance_officer",
    "scenario": "정책 준수 점검",
    "source_files": [
      "ce1.xml",
      "ce2.xml",
      "sample10.xml",
      "sample7.xml",
      "sample8.xml",
      "sample9.xml"
    ],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "required_metric": "ssh_acl_applied_check",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "ssh_enabled_devices",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "system_hostname_text",
          "metric_params": {
            "scope": "all_devices"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {
        "step_None_ssh_acl_applied_check": false,
        "step_None_ssh_enabled_devices": [
          "CE1",
          "CE2",
          "sample10",
          "sample7",
          "sample8",
          "sample9"
        ],
        "step_None_system_hostname_text": "CE1"
      }
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-006",
    "question": "각 장비의 로컬 로그 버퍼가 규정상 요구되는 최소 심각도(예: informational 또는 warnings 수준)로 설정되어 있는가? 미준수 장비에 대해 설정 변경 권고와 감사용 수집 방안을 제시하라.",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": {
      "CE1": {
        "compliance": "unknown",
        "recommended_setting": "로컬 로그 버퍼의 최소 심각도를 정책에 따라 informational(또는 warning) 이상으로 설정 (예: Cisco 계열의 경우 'logging buffered informational')",
        "audit_collection": [
          "현재 설정 확보: CLI로 'show running-config | include logging' 및 'show logging' 등 관련 출력 저장",
          "로그 버퍼 및 심각도 설정 스냅샷을 중앙 감사저장소(NMS 또는 파일서버)로 전송하여 보관",
          "설정 변경 시 변경 전/후 스냅샷과 변경 명령 이력(명령어 기록, 변경 요청 티켓)을 함께 보관하여 감사 증거로 제출"
        ]
      }
    },
    "explanation": "제공된 증거에는 단말 CE1의 로컬 로그 버퍼 심각도 설정값이 포함되어 있지 않으므로 해당 장비의 규정 준수 여부를 판정할 수 없습니다. 따라서 compliance 상태는 'unknown'으로 표기했습니다. 권고 설정으로는 정책에서 요구하는 최소 심각도(informational 또는 warning) 이상으로 로컬 로그 버퍼를 설정하는 것을 권장합니다. 예를 들어 Cisco 장비에서는 'logging buffered informational' 명령으로 버퍼의 최소 심각도를 설정할 수 있습니다. 감사용 수집 방안은 다음과 같습니다. 첫째, 현재 설정을 수집하기 위해 CLI에서 'show running-config | include logging' 및 'show logging' 같은 명령을 실행하여 출력 결과를 캡처합니다. 둘째, 캡처한 출력(설정 스냅샷 및 로그 관련 출력)을 중앙 감사저장소나 NMS로 전송하여 변경 전 증거로 보관합니다. 셋째, 설정 변경이 필요한 경우 변경 전 스냅샷을 보관한 뒤 변경 명령 실행, 변경 후 스냅샷을 다시 수집하여 변경 전·후 증거를 확보합니다. 마지막으로, 감사 목적의 증빙으로는 (1) 장비별 설정 스냅샷, (2) 변경 명령 및 명령 실행 시간·사용자 로그, (3) 중앙에 저장된 로그 수집 결과(가능하면 syslog 서버로의 전송 기록)를 포함해야 합니다. 또한 장비별로 공급사/모델에 따라 명령어가 다르므로 실제 적용 전 해당 장비의 관리 문서를 참조하여 정확한 명령과 저장 위치를 확인해야 합니다.",
    "answer_type": "long",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "compliance_officer",
    "scenario": "정책 준수 점검",
    "source_files": [
      "ce1.xml",
      "ce2.xml",
      "sample10.xml",
      "sample7.xml",
      "sample8.xml",
      "sample9.xml"
    ],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_logging",
          "params": {
            "host": "all_devices"
          }
        },
        {
          "intent": "show_log_include",
          "params": {
            "host": "all_devices"
          }
        },
        {
          "required_metric": "system_hostname_text",
          "metric_params": {
            "scope": "all_devices"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {
        "step_None_system_hostname_text": "CE1"
      }
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-007",
    "question": "장비들이 원격 Syslog(중앙 로그 수집)로 로그를 전송하고 있는가? 원격 로그 미구성 장비에 대해 우선 적용 방안을 제시하라.",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": [
      "CE1"
    ],
    "explanation": "증거의 'None단계 (system_hostname_text): CE1'은 CE1 장비가 원격 Syslog(중앙 로그 수집)로 로그를 전송하도록 구성되어 있지 않음을 의미합니다. 따라서 현재 원격 로그를 전송하지 않는 장비는 CE1입니다. 우선 적용 방안(우선순위 순)은 다음과 같습니다. 1) 인벤토리 및 확인: 네트워크 전반에서 원격 로그 미구성 장비를 추가로 식별하고 우선순위를 매깁니다(업타임, 중요 서비스 호스팅 여부 기준). 2) 중앙 수집기 정보 확정: 중앙 Syslog 서버의 IP/호스트명, 포트(예: UDP 514 또는 TCP/TLS), 프로토콜, 로그 포맷과 보존 정책을 확정합니다. 3) 네트워크 연결 검증: CE1에서 중앙 수집기까지의 경로, 방화벽/ACL 규칙을 점검하여 포트/프로토콜 접근이 가능한지 확인합니다. 4) 기본 구성 적용: CE1에 최소한의 원격 로그 설정을 적용합니다(예: logging host <syslog_IP> / logging trap <severity> 등). 5) 전송 보안 및 신뢰성 설정: 필요 시 TCP/TLS 전송, 인증서 또는 IPsec을 적용하고 로컬 버퍼링/재전송 정책을 설정합니다. 6) 검증 및 모니터링: 설정 후 CE1에서 테스트 로그를 전송하여 수집기에서 수신 확인을 수행하고, 수집 실패 시 네트워크/설정 로그를 점검합니다. 7) 운영 절차 반영: 변경관리, 롤백 계획, 모니터링 알람 및 주기적 감사 절차를 문서화하여 향후 동일 문제 재발을 방지합니다. 위 단계들을 우선순위 순으로 적용하면 CE1을 포함한 미구성 장비들을 신속하고 안전하게 중앙 로그 수집 환경에 통합할 수 있습니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "compliance_officer",
    "scenario": "정책 준수 점검",
    "source_files": [
      "ce1.xml",
      "ce2.xml",
      "sample10.xml",
      "sample7.xml",
      "sample8.xml",
      "sample9.xml"
    ],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_logging",
          "params": {
            "host": "all_devices"
          }
        },
        {
          "required_metric": "system_hostname_text",
          "metric_params": {
            "scope": "all_devices"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {
        "step_None_system_hostname_text": "CE1"
      }
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-008",
    "question": "SSH가 활성화된 장비의 관리 경로(직접/프록시/점프서버)와 그 접근통제(로그, ACL, 점프서버 감사)가 문서화되어 있는가? 문서화가 부족한 항목에 대해 개선 권고를 제시하라.",
    "context": "보안 설정 현황:\nCE1: SSH ON, AAA OFF\nCE2: SSH ON, AAA OFF\nsample10: SSH ON, AAA ON\nsample7: SSH ON, AAA ON\nsample8: SSH ON, AAA ON",
    "ground_truth": "문서화 여부 불명 (제공된 증거로는 관리경로 및 접근통제 문서화 여부를 판단할 수 없음)",
    "explanation": "제공된 증거는 SSH가 활성화된 장비 목록(총 6대, 예: CE1, CE2, sample10 등)과 ssh_missing_count가 0이라는 사실만을 나타냅니다. 이는 SSH 활성화 상태에 관한 정보일 뿐, 각 장비의 관리 경로(직접 접속/프록시/점프서버)나 해당 경로에 대한 접근통제(로그 설정, ACL, 점프서버 감사 여부 등)가 문서화되어 있는지에 대한 정보를 포함하고 있지 않습니다. 따라서 현재 증거만으로는 문서화 여부를 '있음' 또는 '없음'으로 판정할 수 없습니다. 개선 권고는 다음과 같습니다. (1) 자산 목록 기반 문서화: SSH 활성화 장비 목록을 바탕으로 각 장비별 관리경로(직접/프록시/점프서버)를 명확히 기재하고 중앙 CMDB 또는 운영 매뉴얼에 등록하십시오. (2) 접근통제 항목 문서화: 각 경로별로 적용된 접근통제 내용을 문서화하십시오(로그 수집 정책, ACL 규칙집, 점프서버 접속자 목록 및 권한, MFA 적용 여부 등). (3) 로그 및 감사 체계 명시: SSH 접속 로그의 저장 위치, 보존기간, 로그 포맷 및 중앙 수집(SIEM) 연동 여부와 점프서버 세션 녹화/감사 절차를 문서화하십시오. (4) 표준 템플릿 적용: 장비별 문서 템플릿(예: 관리경로, 접속 계정/역할, ACL 요약, 로그/감사 설정, 책임자)을 만들어 누락을 방지하십시오. (5) 정책 및 검증 절차: 주기적 검토 및 감사를 통해 문서와 실제 설정(ACL, 로그 활성화, 점프서버 사용 여부)이 일치하는지 확인하는 절차를 수립하십시오. (6) 보완 기술 권고: 가능한 경우 퍼블릭 접속을 차단하고 중앙 점프서버(bastion)로의 집중화를 권장하며, 점프서버에는 강제 세션 로깅, 세션 관리, MFA를 적용하십시오. (7) 우선순위 권고: 먼저 6대의 SSH 활성화 장비 각각에 대해 관리경로 및 로그/ACL/점프서버 감사 항목의 존재 여부를 확인하고 문서화 대상 목록을 작성한 뒤, 문서화가 불충분한 장비부터 순차적으로 보완하십시오. 이러한 조치를 통해 문서화의 완전성 및 접근통제의 추적 가능성을 확보할 수 있습니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "compliance_officer",
    "scenario": "정책 준수 점검",
    "source_files": [
      "ce1.xml",
      "ce2.xml",
      "sample10.xml",
      "sample7.xml",
      "sample8.xml",
      "sample9.xml"
    ],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "required_metric": "ssh_enabled_devices",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "ssh_missing_count",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "intent": "ssh_proxy_jump",
          "params": {
            "host": "management_jump_host"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {
        "step_None_ssh_enabled_devices": [
          "CE1",
          "CE2",
          "sample10",
          "sample7",
          "sample8",
          "sample9"
        ],
        "step_None_ssh_missing_count": 0
      }
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-009",
    "question": "감사 제출용으로 어떤 명령 출력(증빙)이 최소한으로 필요하며, 각 항목을 자동으로 수집할 수 있는가? (수집 명령과 장비 단위 수집 계획 포함)",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": [
      {
        "item": "running_config",
        "auto_collectable": true,
        "collection_commands": [
          "show running-config",
          "show running-config | include username",
          "show running-config | include enable secret",
          "show running-config | include service password-encryption",
          "show running-config | include ip ssh",
          "show running-config | include aaa",
          "show running-config | section line vty",
          "show running-config | include security passwords",
          "show running-config | include password"
        ],
        "per_device_collection_plan": "Connect to each device via SSH (or console if SSH not available). Enter enable mode if required and run the listed commands. Capture and store outputs in the central collector. Use vendor-specific filters if device output differs (e.g., 'show configuration' / 'show configuration | display set' on Junos)."
      },
      {
        "item": "startup_config",
        "auto_collectable": true,
        "collection_commands": [
          "show startup-config"
        ],
        "per_device_collection_plan": "From the same SSH session, run 'show startup-config' to capture the saved configuration for comparison with running-config. Store the output alongside the running-config output."
      },
      {
        "item": "software_and_hardware_fingerprint",
        "auto_collectable": true,
        "collection_commands": [
          "show version",
          "show inventory"
        ],
        "per_device_collection_plan": "Run 'show version' and vendor equivalent to capture OS version, image, platform, and serial numbers. This provides device identity and supports auditor verification."
      },
      {
        "item": "SSH_version_and_ssh_settings",
        "auto_collectable": true,
        "collection_commands": [
          "show ip ssh",
          "show running-config | include ip ssh",
          "show running-config | include ip domain-name",
          "show crypto key mypubkey rsa"
        ],
        "per_device_collection_plan": "Collect SSH-specific commands to prove the configured SSH version and key configuration. If device reports SSHv2 in 'show ip ssh', capture that output; otherwise capture configuration lines that show SSH settings."
      },
      {
        "item": "AAA_configuration_presence",
        "auto_collectable": true,
        "collection_commands": [
          "show running-config | section aaa",
          "show running-config | include aaa",
          "show running-config | include tacacs",
          "show running-config | include radius",
          "show tacacs",
          "show aaa servers"
        ],
        "per_device_collection_plan": "Collect AAA configuration and any configured external server definitions to prove presence or absence of AAA. If vendor uses different commands, map to vendor equivalent (e.g., 'show configuration | display set | match authentication' on Junos)."
      },
      {
        "item": "authentication_and_authorization_lines",
        "auto_collectable": true,
        "collection_commands": [
          "show running-config | section line vty",
          "show line",
          "show running-config | include login local",
          "show running-config | include authentication"
        ],
        "per_device_collection_plan": "Capture VTY/console line configuration and current line session states to demonstrate what authentication methods are applied for management access."
      },
      {
        "item": "local_user_accounts_and_secrets",
        "auto_collectable": true,
        "collection_commands": [
          "show running-config | include username",
          "show running-config | include username .* privilege",
          "show running-config | include enable secret",
          "show running-config | include enable password"
        ],
        "per_device_collection_plan": "Collect configured local users and enable secret lines from running-config. Note that secrets are typically stored encrypted and cannot be decrypted; the existence (or absence) of enable secret/username entries is the audit evidence."
      },
      {
        "item": "password_policy_settings",
        "auto_collectable": true,
        "collection_commands": [
          "show running-config | include security passwords",
          "show running-config | include password strength",
          "show running-config | include min-length",
          "show running-config | include service-password-encryption",
          "show running-config | include password-policy",
          "show configuration | display set | match password"
        ],
        "per_device_collection_plan": "Collect configuration lines that implement password policy (minimum length, complexity checks, history, aging) or demonstrate their absence. If vendor uses different syntax, use vendor-specific commands to capture equivalent settings."
      },
      {
        "item": "AAA_server_reachability_and_status",
        "auto_collectable": true,
        "collection_commands": [
          "show tacacs servers",
          "show radius servers",
          "test aaa-server authentication <name> <username> <password>",
          "ping <aaa_server_ip>",
          "show aaa authentication sessions"
        ],
        "per_device_collection_plan": "If AAA servers are configured, collect server definitions and simple reachability/status tests to demonstrate that the configured AAA infrastructure is reachable and used. Note that credentials for live tests must be handled securely and may require consent."
      },
      {
        "item": "authentication_and_audit_logs",
        "auto_collectable": true,
        "collection_commands": [
          "show logging",
          "show log",
          "show accounting",
          "show aaa accounting",
          "show logging | include %SEC_EXEC|%AUTH"
        ],
        "per_device_collection_plan": "Collect device logs and accounting outputs to show recent authentication/authorization events. Rotate and archive logs on the collector; if logs are sent to external syslog, collect the central syslog entries instead of device logs."
      }
    ],
    "explanation": "The evidence shows ssh_version_text = 2, which indicates the device reports SSH version 2 is configured, while aaa_present_bool and password_policy_present_bool are both flagged as missing. For an audit you must provide minimal, verifiable command outputs that prove (1) management access settings such as SSH and line authentication, (2) whether AAA is configured and which servers (if any) are defined, (3) local account/secret existence, and (4) explicit password policy settings or evidence of their absence. The running-config and startup-config are the canonical sources for configuration state and therefore are always required. 'show version' provides device identity and image data required by auditors. SSH settings (e.g., 'show ip ssh' or the ip ssh lines in config) are required to confirm SSHv2 is in use, which the evidence already indicates but still must be captured as output. AAA presence or absence must be proven by capturing the AAA sections or the lack thereof in the running-config and the AAA server lists; these commands are automatable via SSH/NETCONF/RESTCONF and can be filtered to reduce volume. Password policy settings are typically expressed by specific configuration lines (for example 'security passwords min-length', 'password strength-check', 'password-policy' or vendor equivalents); collecting filtered running-config output will demonstrate whether such settings exist or are missing. Authentication/authorization lines (line vty, console) and local usernames/enable secret lines prove how management logins are authenticated; note that secrets are encrypted and cannot be reversed, but their presence/absence still provides audit evidence. AAA server reachability and authentication/accounting logs are useful to demonstrate that external authentication is functional; these can be tested/collected but require careful handling of test credentials and may be environment-sensitive. All listed items are automatable in a standard collector workflow: the collector connects via SSH (or vendor API/NETCONF/RESTCONF), escalates to enable if needed, runs the vendor-appropriate commands, and stores outputs in a secure central repository. Vendor differences must be handled by mapping equivalent commands (for example IOS vs NX-OS vs Junos), and limitations such as encrypted secrets or inaccessible devices (no network access, no credentials) must be documented as exceptions. Because the provided evidence already shows SSHv2 but lacks AAA and password policy, priority should be given to collecting the AAA-related configuration and any password-policy lines to produce definitive audit evidence of their absence or presence.",
    "answer_type": "long",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "compliance_officer",
    "scenario": "정책 준수 점검",
    "source_files": [
      "ce1.xml",
      "ce2.xml",
      "sample10.xml",
      "sample7.xml",
      "sample8.xml",
      "sample9.xml"
    ],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_users",
          "params": {
            "host": "all_devices"
          }
        },
        {
          "intent": "show_logging",
          "params": {
            "host": "all_devices"
          }
        },
        {
          "required_metric": "ssh_version_text",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "aaa_present_bool",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "password_policy_present_bool",
          "metric_params": {
            "scope": "all_devices"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {
        "step_None_ssh_version_text": "2",
        "step_None_aaa_present_bool": false,
        "step_None_password_policy_present_bool": false
      }
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-010",
    "question": "현재 수집 가능한 지표를 바탕으로 미준수 항목(예: AAA 미구성, 패스워드 정책 부재, 로컬 로그 심각도 미달 등)의 우선순위별 개선 로드맵(단계별 작업, 권한자, 기한)을 어떻게 구성할 것인가? 감사 리포트 템플릿 예시를 포함하라.",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": {
      "prioritized_roadmap": [
        {
          "id": "1",
          "issue": "AAA 미구성 가능성(데이터 없음/확인 필요)",
          "severity": "Critical (확인 시)",
          "priority_rank": 1,
          "phases": [
            {
              "phase": "Immediate (1주)",
              "tasks": [
                {
                  "task": "장비 인벤토리 수집 및 AAA 구성 상태(구성 유무/서버 연동 여부) 확인",
                  "owner": "네트워크 운영팀",
                  "due": "1주 이내"
                },
                {
                  "task": "관리계정 일시적 접속 통제 및 중요 관리자 계정 암호 변경",
                  "owner": "시스템/네트워크 운영팀",
                  "due": "3일 이내"
                }
              ]
            },
            {
              "phase": "Short-term (1개월)",
              "tasks": [
                {
                  "task": "TACACS+/RADIUS 도입 여부 결정 및 서버 구축/연동 계획 수립",
                  "owner": "IAM팀 및 네트워크 보안팀",
                  "due": "2주 이내"
                },
                {
                  "task": "장비별 AAA 설정 템플릿 작성 및 파일럿 적용",
                  "owner": "네트워크 보안팀",
                  "due": "4주 이내"
                }
              ]
            },
            {
              "phase": "Medium (1-3개월)",
              "tasks": [
                {
                  "task": "전체 장비에 AAA 적용 배포 및 인증·권한 동기화 완료",
                  "owner": "네트워크 운영팀",
                  "due": "2개월"
                },
                {
                  "task": "인증/인가 로그를 중앙 로그(SIEM)으로 연동 및 모니터링 룰 작성",
                  "owner": "SOC/로그팀",
                  "due": "2개월"
                }
              ]
            },
            {
              "phase": "Long-term (3-6개월)",
              "tasks": [
                {
                  "task": "역할 기반 접근 제어(RBAC) 및 권한 분리 정책 적용",
                  "owner": "IAM팀/정보보호팀",
                  "due": "4개월"
                },
                {
                  "task": "정기 검토 및 SLA 기반 감사·보고 프로세스 수립",
                  "owner": "컴플라이언스팀",
                  "due": "6개월"
                }
              ]
            }
          ]
        },
        {
          "id": "2",
          "issue": "패스워드 정책 부재 (password_policy_present_bool: ❌)",
          "severity": "High",
          "priority_rank": 2,
          "phases": [
            {
              "phase": "Immediate (1주)",
              "tasks": [
                {
                  "task": "영향 범위 식별(AD, 로컬 계정, 네트워크 장비 등) 및 정책 부재 증거 수집",
                  "owner": "시스템/아이덴티티팀",
                  "due": "1주 이내"
                },
                {
                  "task": "임시 비밀번호 규칙(최소길이·문자조합·최소수명) 적용 및 중요 계정 재설정",
                  "owner": "시스템 운영팀",
                  "due": "3일 이내"
                }
              ]
            },
            {
              "phase": "Short-term (1개월)",
              "tasks": [
                {
                  "task": "조직 패스워드 정책 문서화 및 승인",
                  "owner": "IT 리스크/컴플라이언스",
                  "due": "2주 이내"
                },
                {
                  "task": "AD GPO, PAM 또는 기타 중앙 관리 도구를 통한 기술적 강제화 설계 및 적용",
                  "owner": "아이덴티티팀/시스템팀",
                  "due": "4주 이내"
                }
              ]
            },
            {
              "phase": "Medium (1-3개월)",
              "tasks": [
                {
                  "task": "비밀번호 저장 방식(해싱·솔트) 검토 및 필요 시 개선",
                  "owner": "시큐리티 아키텍트",
                  "due": "2개월"
                },
                {
                  "task": "공유계정 제거 및 특권계정 비밀번호 주기적 회전 프로세스 도입",
                  "owner": "운영팀/정보보호팀",
                  "due": "3개월"
                }
              ]
            },
            {
              "phase": "Long-term (3-6개월)",
              "tasks": [
                {
                  "task": "특권계정 우선으로 MFA 도입 및 사용자 인증 강화",
                  "owner": "IAM팀",
                  "due": "4-6개월"
                },
                {
                  "task": "정책 준수 모니터링과 분기별 감사 체계 수립",
                  "owner": "컴플라이언스/SOC",
                  "due": "6개월"
                }
              ]
            }
          ]
        },
        {
          "id": "3",
          "issue": "SSH 프로토콜 버전(ssh_version_text: 2)",
          "severity": "Low",
          "priority_rank": 3,
          "phases": [
            {
              "phase": "Immediate (1주)",
              "tasks": [
                {
                  "task": "SSH 프로토콜 버전이 2로 설정된 장비 목록 및 증거 기록",
                  "owner": "네트워크 운영팀",
                  "due": "3일 이내"
                }
              ]
            },
            {
              "phase": "Short-term (1개월)",
              "tasks": [
                {
                  "task": "SSH 구성 하드닝(약한 암호화/키교환/카이퍼 비활성화, PasswordAuthentication 비활성화 권고 검토)",
                  "owner": "네트워크 보안팀",
                  "due": "2주 이내"
                },
                {
                  "task": "관리 접근 제한(IP 화이트리스트, 관리 VLAN) 및 세션 타임아웃 설정",
                  "owner": "네트워크 운영팀",
                  "due": "4주 이내"
                }
              ]
            },
            {
              "phase": "Medium (1-3개월)",
              "tasks": [
                {
                  "task": "키 기반 인증 도입 및 키 관리 정책 수립",
                  "owner": "IAM/네트워크 보안팀",
                  "due": "2개월"
                },
                {
                  "task": "SSH 접속 이벤트 SIEM 연동 및 경보 규칙 추가",
                  "owner": "SOC",
                  "due": "2개월"
                }
              ]
            },
            {
              "phase": "Long-term (3-6개월)",
              "tasks": [
                {
                  "task": "정기 키 교체 정책 및 구성 검토를 통한 지속적 하드닝",
                  "owner": "정보보호팀",
                  "due": "6개월"
                }
              ]
            }
          ]
        }
      ],
      "audit_report_template": {
        "header": {
          "title": "감사 리포트",
          "organization": "[조직명]",
          "date": "YYYY-MM-DD",
          "auditor": "[감사자 이름/팀]",
          "period_of_review": "[검토 기간]"
        },
        "executive_summary": "[요약: 주요 위협, 우선순위 및 주요 권고사항 한 단락]",
        "scope_and_methodology": "[대상 시스템/장비, 수집 데이터(설정, 로그 등), 수행 방법(설정검토·로그분석·인터뷰 등)]",
        "findings": [
          {
            "id": 1,
            "title": "[간단 제목]",
            "severity": "[Critical/High/Medium/Low]",
            "description": "[문제 상세 설명]",
            "evidence": "[증거: 설정 값, 로그 스니펫, 스크린샷 등]",
            "impacted_assets": [
              "[장비/시스템 식별자]"
            ],
            "recommendation": "[구체적 권고 조치(단계 포함)]",
            "owner": "[책임부서/담당자]",
            "target_date": "YYYY-MM-DD",
            "status": "[Open/In Progress/Closed]"
          }
        ],
        "remediation_plan_summary": "[우선순위별 종합 개선 계획 표]",
        "risk_rating_methodology": "[영향도·발생확률 등 위험등급 산정 기준]",
        "kpis_and_metrics": {
          "example_metrics": [
            "미구성 장비 수",
            "정책 적용률(%)",
            "특권계정 MFA 적용 비율",
            "로그 연동 완료 장비 수"
          ]
        },
        "approval_and_signoff": {
          "it_leader": "[이름/서명]",
          "ciso": "[이름/서명]",
          "auditor": "[이름/서명]"
        },
        "appendices": "[명령어 출력, 전체 증거 목록, 로그 추출 방법 등 부속 자료]"
      }
    },
    "explanation": "제공된 증거에서 password_policy_present_bool이 ❌로 명확히 패스워드 정책 부재를 나타내므로 우선순위 상 '패스워드 정책 부재'를 빠르게 식별하고 기술적 강제화 및 조직 정책 수립을 통해 수정해야 합니다. aaa_missing_devices 항목은 현재 'None'으로 표기되어 있어 데이터가 수집되지 않았거나 상태 확인이 이루어지지 않은 것으로 판단됩니다. AAA 미구성이 실제로 존재할 경우 영향을 받는 범위가 넓고 권한·계정 통제가 불가능해지는 등 심각한 보안 위험을 초래할 수 있으므로, 우선 인벤토리와 구성 상태 확인을 즉시 수행한 뒤 미구성 장비가 확인되면 최우선으로 AAA 도입·연동을 진행하도록 우선순위를 1순위로 배치했습니다. ssh_version_text가 '2'로 나타난 것은 프로토콜 버전 측면에서 기본 요건(SSH v2)을 충족하므로 우선순위는 낮게 두되, 구성 하드닝(약한 암호화 알고리즘 비활성화, 키 기반 인증 권장, 접속 제한 등)은 권장되는 보완 조치이므로 단계적 작업으로 포함했습니다. 각 단계별 기한은 즉시 위험을 줄이기 위한 단기(3일~1주) 조치와 운영·구축이 필요한 단기~중기(2~8주), 정책 완성 및 운영 체계화가 필요한 장기(3~6개월)로 구분하여 현실적 실행 가능성을 반영했습니다. 역할(Owner)은 일반적으로 장비 구성·운영을 담당하는 네트워크 운영팀, 정책·아이덴티티 관리를 담당하는 IAM/시스템팀, 감시·알림·로그 연동을 담당하는 SOC 및 로그팀, 정책·감사·승인을 담당하는 컴플라이언스 및 정보보호팀으로 분배하는 것이 실행과 책임소재 관리를 명확히 하므로 추천합니다. 마지막으로 감사 리포트 템플릿은 실행 결과의 추적과 우선순위 확인, 책임자 지정을 위해 표준 항목(요약·범위·증거·권고·소유자·기한·상태)을 포함하도록 구성했습니다.",
    "answer_type": "long",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "compliance_officer",
    "scenario": "정책 준수 점검",
    "source_files": [
      "ce1.xml",
      "ce2.xml",
      "sample10.xml",
      "sample7.xml",
      "sample8.xml",
      "sample9.xml"
    ],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "required_metric": "aaa_missing_devices",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "password_policy_present_bool",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "required_metric": "ssh_version_text",
          "metric_params": {
            "scope": "all_devices"
          }
        },
        {
          "intent": "show_logging",
          "params": {
            "host": "all_devices"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {
        "step_None_aaa_missing_devices": null,
        "step_None_password_policy_present_bool": false,
        "step_None_ssh_version_text": "2"
      }
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-001",
    "question": "rtr-core1에서 iBGP 세션이 수립되지 않습니다(원인 가정: AS 번호 불일치 AS mismatch). 문제를 진단하기 위해 rtr-core1에서 순서대로 실행할 CLI 명령어 3가지를 적어주세요.",
    "context": "BGP 설정 현황:\nCE1: AS65001, 1개 피어\nCE2: AS65003, 1개 피어\nsample10: AS65000, 3개 피어\nsample7: AS65000, 3개 피어\nsample8: AS65000, 3개 피어",
    "ground_truth": [
      "show ip bgp summary",
      "show ip bgp neighbors <peer-ip> detail",
      "show running-config | section router bgp"
    ],
    "explanation": "첫 번째 명령어는 전체 BGP 이웃들의 상태를 빠르게 확인하여 어떤 피어가 Down인지, 피어의 IP와 상태(Idle/Active/Active(Negotiation)/Established 등)를 확인하기 위해 사용합니다. 두 번째 명령어는 특정 피어(<peer-ip>)의 상세 정보를 보여주며 Remote AS 값, 최근 에러 메시지(예: ‘bad peer AS’나 ‘wrong AS’ 관련 로그) 및 세션 협상 과정의 상세 원인을 확인하는 데 필요합니다. 세 번째 명령어는 라우터의 BGP 설정(로컬 AS 번호와 neighbor 설정 포함)을 직접 확인하여 로컬에 설정된 AS 번호와 이웃에 설정된 remote-as 값이 일치하는지, 설정상 오타나 잘못된 IP가 없는지 검증하기 위해 사용합니다. 이 순서대로 진단하면 먼저 문제가 발생한 피어를 식별하고 해당 피어의 실제 remote AS 값을 확인한 다음 로컬 설정과 대조하여 AS 불일치 여부를 확정할 수 있습니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "troubleshooter",
    "scenario": "장애 진단 명령어 시퀀스",
    "source_files": [],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_bgp_summary",
          "params": {
            "host": "rtr-core1"
          }
        },
        {
          "intent": "show_bgp_neighbors",
          "params": {
            "host": "rtr-core1"
          }
        },
        {
          "intent": "show_bgp_neighbor_detail",
          "params": {
            "host": "rtr-core1",
            "neighbor_ip": "10.0.12.2"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {}
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-002",
    "question": "rtr-edge1에서 rtr-pe1로의 eBGP 세션이 DOWN입니다(원인 가정: 원격 AS 설정 오류). rtr-edge1에서 진단을 위해 순서대로 실행할 CLI 명령 3가지를 적어주세요.",
    "context": "BGP 설정 현황:\nCE1: AS65001, 1개 피어\nCE2: AS65003, 1개 피어\nsample10: AS65000, 3개 피어\nsample7: AS65000, 3개 피어\nsample8: AS65000, 3개 피어",
    "ground_truth": [
      "show ip bgp summary",
      "show ip bgp neighbors <PEER_IP> detail",
      "show running-config | section router bgp"
    ],
    "explanation": "첫 번째 명령은 전체 BGP 피어들의 상태를 빠르게 확인하여 rtr-pe1과의 세션이 실제로 DOWN인지와 상태(Idle/Active/Connect 등)를 확인하기 위함입니다. 두 번째 명령은 특정 피어(<PEER_IP>)에 대한 상세 정보를 보여주어 현재 보고되는 Remote AS 값, 로컬 AS와의 불일치 여부, 최근 에러 메시지(TCP 재시도, 버전/AS 불일치 등)를 확인하는 데 필요합니다. 세 번째 명령은 라우터의 실제 BGP 설정을 확인하여 neighbor 구문에 설정된 remote-as 값이 무엇인지 검증하고, 상세 출력에서 보인 Remote AS와 비교하여 설정 오류(원격 AS 입력 실수 등)를 찾아내기 위함입니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "troubleshooter",
    "scenario": "장애 진단 명령어 시퀀스",
    "source_files": [],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_bgp_summary",
          "params": {
            "host": "rtr-edge1"
          }
        },
        {
          "intent": "show_bgp_neighbors",
          "params": {
            "host": "rtr-edge1"
          }
        },
        {
          "intent": "show_bgp_neighbor_detail",
          "params": {
            "host": "rtr-edge1",
            "neighbor_ip": "203.0.113.1"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {}
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-003",
    "question": "rtr-core2에서 일부 iBGP 피어가 빠져 경로가 제대로 학습되지 않습니다(원인 가정: iBGP 피어 설정 누락). rtr-core2에서 순서대로 실행할 CLI 명령 3가지를 적어주세요.",
    "context": "BGP 설정 현황:\nCE1: AS65001, 1개 피어\nCE2: AS65003, 1개 피어\nsample10: AS65000, 3개 피어\nsample7: AS65000, 3개 피어\nsample8: AS65000, 3개 피어",
    "ground_truth": [
      "show ip bgp summary",
      "show running-config | section router bgp",
      "show ip bgp"
    ],
    "explanation": "첫 번째 명령어(show ip bgp summary)는 rtr-core2에서 설정된 BGP 피어들의 상태(UP/Idle/Active 등)와 수신/송신된 경로수를 빠르게 확인하기 위해 사용합니다. 두 번째 명령어(show running-config | section router bgp)는 실제로 iBGP 피어가 설정되어 있는지를 확인하고, ASN 또는 neighbor 문구가 누락되었는지, 또는 설정 오류(예: 잘못된 neighbor IP나 update-source 등)가 있는지를 검토하기 위해 사용합니다. 세 번째 명령어(show ip bgp)는 현재 학습된 BGP 경로들을 확인하여 어떤 경로들이 누락되었는지, iBGP로부터 경로가 수신되지 않는지 여부를 확인하기 위해 사용합니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "troubleshooter",
    "scenario": "장애 진단 명령어 시퀀스",
    "source_files": [],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_bgp_neighbors",
          "params": {
            "host": "rtr-core2"
          }
        },
        {
          "intent": "show_bgp_summary",
          "params": {
            "host": "rtr-core2"
          }
        },
        {
          "intent": "show_route_table",
          "params": {
            "host": "rtr-core2"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {}
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-004",
    "question": "rtr-dc1에서 rtr-edge2 방향 L2VPN이 일방향 트래픽만 흐릅니다(원인 가정: VC 상태 불일치). rtr-dc1에서 순서대로 실행할 CLI 명령 3가지를 적어주세요.",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": [
      "show mpls l2transport vc summary",
      "show mpls l2transport vc <vc-id> detail",
      "clear mpls l2transport vc <vc-id>"
    ],
    "explanation": "첫 번째 명령은 장비에 구성된 모든 L2VPN/VC의 전반적인 상태를 확인하여 어떤 VC가 불일치하거나 문제가 있는지 식별하기 위함입니다. 두 번째 명령은 문제로 의심되는 특정 VC의 상세 상태(로컬/원격 상태, LDP/PW 상태, 제어워드 등)를 확인하여 일방향 트래픽의 원인이 VC 상태 불일치인지 확정하기 위해 사용합니다. 세 번째 명령은 해당 VC를 재설정하여 원격 쪽과의 상태 동기화를 시도하고 PW를 재성립함으로써 일방향 문제를 해결하려는 조치입니다. 실제 실행 시 <vc-id>는 대상 VC의 식별자로 치환하고, 필요하면 rtr-edge2에서도 동일한 상태 확인을 병행해야 합니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "troubleshooter",
    "scenario": "장애 진단 명령어 시퀀스",
    "source_files": [],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_l2vpn_vc",
          "params": {
            "host": "rtr-dc1"
          }
        },
        {
          "intent": "show_l2vpn_status",
          "params": {
            "host": "rtr-dc1"
          }
        },
        {
          "intent": "show_interface_status",
          "params": {
            "host": "rtr-dc1",
            "interface": "GigabitEthernet0/1"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {}
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-005",
    "question": "rtr-dc1에서 rtr-edge1로 연결된 L2VPN이 불안정합니다(원인 가정: PW ID mismatch). rtr-dc1에서 순서대로 실행할 CLI 명령 3가지를 적어주세요.",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": [
      "show mpls l2transport vc <pw-id> detail",
      "show mpls l2transport vc summary",
      "show running-config | section xconnect"
    ],
    "explanation": "첫 번째 명령인 \"show mpls l2transport vc <pw-id> detail\"은 특정 pseudowire(PW)의 상세 상태를 확인하기 위해 사용합니다. 이 출력에서 로컬/원격 PW ID, 상태(state), 바인딩 정보 및 오류 메시지(예: PW ID mismatch 관련 정보)를 확인할 수 있으므로 문제 원인 추적의 출발점입니다. 두 번째 명령인 \"show mpls l2transport vc summary\"는 모든 L2VPN 가상회선의 요약 상태를 한눈에 보여 주므로 해당 PW의 전반적인 상태(Up/Down, 분포 등)를 빠르게 확인하고 다른 관련 VC의 상태와 비교할 수 있습니다. 세 번째 명령인 \"show running-config | section xconnect\"는 장비에 설정된 xconnect/пseudowire 구성 부분을 검토하여 로컬에 설정된 PW ID가 의도한 값과 일치하는지, 그리고 잘못된 PW ID가 설정되어 있는지 직접 확인할 수 있게 해줍니다. 각 명령에서 얻은 PW ID와 원격 엔드(rtr-edge1)의 구성에 설정된 PW ID를 비교하여 불일치 여부를 확인하면 PW ID mismatch 문제를 확정할 수 있습니다. (명령어의 세부 구문은 장비 벤더/OS에 따라 다를 수 있으므로 필요 시 해당 플랫폼의 동등한 명령을 사용하십시오.)",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "troubleshooter",
    "scenario": "장애 진단 명령어 시퀀스",
    "source_files": [],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_l2vpn_vc",
          "params": {
            "host": "rtr-dc1"
          }
        },
        {
          "intent": "show_l2vpn_status",
          "params": {
            "host": "rtr-dc1"
          }
        },
        {
          "intent": "show_log_include",
          "params": {
            "host": "rtr-dc1",
            "string": "l2vpn|pw|pseudowire|pw-id"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {}
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-006",
    "question": "rtr-core2에서 OSPF area 0 이웃이 DOWN입니다(원인 가정: 인터페이스 다운 또는 area 설정 불일치). rtr-core2에서 순서대로 실행할 CLI 명령 3가지를 적어주세요.",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": [
      "show ip ospf neighbor",
      "show ip interface brief",
      "show ip ospf interface"
    ],
    "explanation": "첫째로 'show ip ospf neighbor'를 실행하여 어떤 이웃이 DOWN인지, 이웃의 Router ID와 해당 이웃이 사용하던 인터페이스(또는 인터페이스 이름)를 확인합니다. 둘째로 'show ip interface brief'를 실행하여 앞서 확인한 인터페이스의 물리적/관리적 상태(up/down, administratively down, IP 할당 여부 등)를 점검하여 인터페이스 다운 여부를 확인합니다. 셋째로 'show ip ospf interface'를 실행하여 해당 인터페이스에 설정된 OSPF area와 인터페이스별 OSPF 파라미터(Hello/Dead 타이머, 네트워크 타입 등)를 확인함으로써 area 설정 불일치나 OSPF 설정 문제를 진단합니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "troubleshooter",
    "scenario": "장애 진단 명령어 시퀀스",
    "source_files": [],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_ip_interface_brief",
          "params": {
            "host": "rtr-core2"
          }
        },
        {
          "intent": "show_ip_ospf_neighbor",
          "params": {
            "host": "rtr-core2"
          }
        },
        {
          "intent": "show_ospf_database",
          "params": {
            "host": "rtr-core2"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {}
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-007",
    "question": "rtr-edge2에서 특정 네트워크 경로가 보이지 않습니다(원인 가정: OSPF에서 학습되지 않거나 redistribution 누락). rtr-edge2에서 순서대로 실행할 CLI 명령 3가지를 적어주세요.",
    "context": "총 장비 수: 6 | 사용 기술: BGP, OSPF, L2VPN, L3VPN | AS 번호: 65000, 65001, 65003",
    "ground_truth": [
      "show ip route <network>",
      "show ip ospf database",
      "show running-config | section router ospf"
    ],
    "explanation": "첫 번째 명령어인 'show ip route <network>'는 rtr-edge2의 라우팅 테이블에서 해당 네트워크가 실제로 없는지, 있고 나면 그 출처(source)가 무엇인지(OSPF, 연결된, 정적 등)를 확인하기 위해 실행합니다. 두 번째로 'show ip ospf database'를 실행하면 해당 네트워크에 대한 LSA가 OSPF의 LSDB에 존재하는지 확인할 수 있으므로 OSPF로부터 학습되었는지 여부를 판단할 수 있습니다. 세 번째로 'show running-config | section router ospf'는 OSPF 설정과 redistribution 관련 명령이 올바르게 구성되어 있는지(예: redistribute 문이 누락되었는지)를 확인하기 위해 사용합니다. 이 순서는 라우팅 테이블 확인 → OSPF 학습 여부 확인 → 재배포/설정 확인이라는 논리적 진단 흐름을 따릅니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "troubleshooter",
    "scenario": "장애 진단 명령어 시퀀스",
    "source_files": [],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_ip_route_ospf",
          "params": {
            "host": "rtr-edge2",
            "prefix": "10.10.0.0/16"
          }
        },
        {
          "intent": "show_route_table",
          "params": {
            "host": "rtr-edge2",
            "prefix": "10.10.0.0/16"
          }
        },
        {
          "intent": "show_bgp_summary",
          "params": {
            "host": "rtr-edge2"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {}
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-008",
    "question": "rtr-pe1에서 특정 Prefix가 반복적으로 BGP로 플랩합니다(원인 가정: 피어 재설정 또는 next-hop 변경). rtr-pe1에서 순서대로 실행할 CLI 명령 3가지를 적어주세요.",
    "context": "BGP 설정 현황:\nCE1: AS65001, 1개 피어\nCE2: AS65003, 1개 피어\nsample10: AS65000, 3개 피어\nsample7: AS65000, 3개 피어\nsample8: AS65000, 3개 피어",
    "ground_truth": [
      "show ip bgp neighbors <peer-ip> detail",
      "show ip bgp <prefix>",
      "debug ip bgp updates"
    ],
    "explanation": "첫 번째 명령인 \"show ip bgp neighbors <peer-ip> detail\"은 해당 피어와의 BGP 세션 상태, 마지막 리셋 시각 및 리셋 원인(reason/notification), 접속/재접속 카운터와 타이머 등을 확인하기 위해 사용합니다. 피어 재설정이 원인이라면 이 출력에서 연속적인 session reset, hold timer 만료 또는 notification 메시지 기록을 확인할 수 있습니다. 두 번째 명령인 \"show ip bgp <prefix>\"는 해당 Prefix의 현재 BGP 경로 정보(수신된 경로들, best path, next-hop, AS PATH 등)를 보여주어 next-hop 변경이나 경로 선호도 변화로 인해 flap이 발생하는지를 판단하게 해줍니다. 특히 반복적으로 next-hop이 바뀌거나 withdraw/announce가 반복되는지, 다른 피어로부터 다른 경로가 들어오는지 확인해야 합니다. 세 번째 명령인 \"debug ip bgp updates\"는 실시간으로 BGP 업데이트(announce/withdraw)를 캡처하여 플랩이 발생하는 정확한 타이밍과 원인을 파악하는 데 사용합니다. 다만 디버그는 CPU 부하를 유발할 수 있으므로 필요한 기간 동안만 실행하고, 콘솔/로그로 결과를 수집한 뒤 즉시 디버그를 취소해야 합니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "troubleshooter",
    "scenario": "장애 진단 명령어 시퀀스",
    "source_files": [],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_bgp_neighbors",
          "params": {
            "host": "rtr-pe1"
          }
        },
        {
          "intent": "show_bgp_neighbor_detail",
          "params": {
            "host": "rtr-pe1",
            "neighbor_ip": "198.51.100.2"
          }
        },
        {
          "intent": "show_route_table",
          "params": {
            "host": "rtr-pe1",
            "prefix": "192.0.2.0/24"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {}
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-009",
    "question": "rtr-edge1의 VRF 'vpn-blue'에서 목적지로의 경로가 보이지 않습니다(원인 가정: VRF-인터페이스 바인딩 누락 또는 라우트 미설치). rtr-edge1에서 순서대로 실행할 CLI 명령 3가지를 적어주세요.",
    "context": "VRF 설정 현황:\nsample10: 1개 VRF (exam-l3vpn)\nsample7: 1개 VRF (exam-l3vpn)\nsample8: 1개 VRF (exam-l3vpn)\nsample9: 1개 VRF (exam-l3vpn)",
    "ground_truth": [
      "show ip vrf vpn-blue",
      "show running-config | include ip vrf forwarding",
      "show ip route vrf vpn-blue"
    ],
    "explanation": "첫 번째 명령어는 VRF 'vpn-blue'가 장비에 존재하는지와 해당 VRF에 바인딩된 인터페이스(출력에 표시되는 경우), RD/RT 등의 기본 정보를 확인하기 위해 사용합니다. 두 번째 명령어는 런닝 구성에서 'ip vrf forwarding vpn-blue' 설정이 실제로 어떤 인터페이스에 적용되어 있는지 빠르게 찾아 VRF-인터페이스 바인딩 누락 여부를 직접 확인하기 위해 사용합니다. 세 번째 명령어는 해당 VRF의 라우팅 테이블에서 목적지 네트워크가 설치되어 있는지 여부를 확인하기 위해 사용하며, 경로가 보이지 않으면 라우트가 미설치이거나 라우팅 프로토콜이 해당 VRF에서 경로를 학습하지 못한 문제임을 시사합니다.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "troubleshooter",
    "scenario": "장애 진단 명령어 시퀀스",
    "source_files": [],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_vrf",
          "params": {
            "host": "rtr-edge1",
            "vrf": "vpn-blue"
          }
        },
        {
          "intent": "show_ip_interface_brief",
          "params": {
            "host": "rtr-edge1"
          }
        },
        {
          "intent": "show_route_table",
          "params": {
            "host": "rtr-edge1",
            "vrf": "vpn-blue"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {}
    }
  },
  {
    "id": "ENHANCED_ENHANCED-DIAGNOSTIC-010",
    "question": "rtr-core1에 SSH 접속이 실패합니다(원인 가정: vty ACL에 의한 차단). rtr-core1에서 순서대로 실행할 CLI 명령 3가지를 적어주세요.",
    "context": "보안 설정 현황:\nCE1: SSH ON, AAA OFF\nCE2: SSH ON, AAA OFF\nsample10: SSH ON, AAA ON\nsample7: SSH ON, AAA ON\nsample8: SSH ON, AAA ON",
    "ground_truth": [
      "show running-config | section line vty",
      "show ip access-lists <acl-name>",
      "show ssh"
    ],
    "explanation": "First, run 'show running-config | section line vty' to see the configuration of the VTY lines on rtr-core1; this will reveal whether an access-class is applied to the vty lines (for example 'access-class <acl-name> in') and also show transport input (ssh/telnet) settings. Second, run 'show ip access-lists <acl-name>' to inspect the actual ACL referenced by the vty lines: check the permit/deny entries, sequence/order, and packet hit counters to determine whether traffic from the SSH client's source IP is being denied by the ACL. Third, run 'show ssh' to verify the SSH server state on the router (enabled version, active sessions, and session counts) to rule out SSH service issues; combining the VTY configuration, the ACL contents/counters, and the SSH service status will confirm whether the vty ACL is the cause of the SSH connection failure.",
    "answer_type": "short",
    "category": "advanced",
    "complexity": "diagnostic",
    "level": 3,
    "persona": "troubleshooter",
    "scenario": "장애 진단 명령어 시퀀스",
    "source_files": [],
    "metadata": {
      "origin": "enhanced_llm_with_agent",
      "reasoning_plan": [
        {
          "intent": "show_logging",
          "params": {
            "host": "rtr-core1",
            "lines": 200
          }
        },
        {
          "intent": "show_log_include",
          "params": {
            "host": "rtr-core1",
            "string": "SSH|vty|login|authentication"
          }
        },
        {
          "intent": "check_connectivity",
          "params": {
            "host": "rtr-core1",
            "target": "198.51.100.10"
          }
        }
      ],
      "reasoning_requirement": "",
      "expected_analysis_depth": "detailed",
      "evidence": {}
    }
  }
]