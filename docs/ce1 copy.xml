<!-- ========================================
     CE1 (Customer Edge 1) 라우터 설정 파일
     - 고객측 라우터로 Provider 네트워크와 연결
     - Cisco IOS 플랫폼 기반
     ======================================== -->
<config xmlns="http://tail-f.com/ns/config/1.0">
  <devices xmlns="http://tail-f.com/ns/ncs">
    <device>
      <!-- 장비 기본 정보 설정 -->
      <name>CE1</name>                    <!-- 라우터 이름: CE1 -->
      <address>172.16.1.40</address>      <!-- 관리용 IP 주소 -->
      <port>22</port>                     <!-- SSH 접속 포트 (기본값 22) -->
      
      <!-- SSH 보안 설정 -->
      <ssh>
        <host-key>
          <algorithm>ssh-rsa</algorithm>  <!-- SSH 암호화 알고리즘: RSA -->
          <key-data>AAAAB3NzaC1yc2EAAAADAQABAAABAQCxZFajeYU+EdQNhzzQ2Pqn7lNwIrdMk5Df+VuHms/I
NgMt03bFDH9IlC4a3GopaQtD7RPO5i9Ax7ukeqVwumTTwwY4e3c1/0YT0SMCIClDMACPOJhB
UHIF6Nm3zttLHTgX13uhe/SjiTGGxATmaAZ4CqB2mjMD235Ae3cLtJrdwnHs0JV5e/DNYwu6
R/H6ornB/CokyV6WV+KBvzpNp6E/Dri6SCT3WwQd3s4WTjekpzMDlRy3hyMuVtHIPM+uiiKC
bZ7SMlYIjt9LEqiv2OLZUWIFqqvNsGyEhE/uBYYQ8+c0hqzkOMfNmpcSTPJuDrOfRjkBGRBY
VDACij1/SioX</key-data>                 <!-- SSH 공개키 데이터 -->
        </host-key>
      </ssh>
      
      <authgroup>kreonet</authgroup>      <!-- 인증 그룹: kreonet -->
      
      <!-- 장비 타입 및 프로토콜 설정 -->
      <device-type>
        <cli>
          <!-- NED (Network Element Driver): Cisco IOS CLI 드라이버 -->
          <ned-id xmlns:cisco-ios-cli-6.109="http://tail-f.com/ns/ned-id/cisco-ios-cli-6.109">cisco-ios-cli-6.109:cisco-ios-cli-6.109</ned-id>
          <protocol>ssh</protocol>       <!-- 관리 프로토콜: SSH -->
        </cli>
      </device-type>
      
      <!-- 장비 상태 -->
      <state>
        <admin-state>unlocked</admin-state>  <!-- 관리상태: 활성화 -->
      </state>
      
      <!-- ========================================
           실제 라우터 설정 부분 시작
           ======================================== -->
      <config>
        <!-- 기본 시스템 설정 -->
        <hostname xmlns="urn:ios">CE1</hostname>         <!-- 라우터 호스트명: CE1 -->
        <tailfned xmlns="urn:ios">
          <police>cirmode</police>                       <!-- Traffic Policing 모드 -->
        </tailfned>
        <version xmlns="urn:ios">15.4</version>          <!-- Cisco IOS 버전: 15.4 -->
        
        <!-- 시스템 서비스 설정 -->
        <service xmlns="urn:ios">
          <timestamps>                                   <!-- 로그 타임스탬프 설정 -->
            <debug>
              <datetime>
                <msec/>                                  <!-- 디버그 로그에 밀리초 포함 -->
              </datetime>
            </debug>
            <log>
              <datetime>
                <msec/>                                  <!-- 일반 로그에 밀리초 포함 -->
              </datetime>
            </log>
          </timestamps>
        </service>
        
        <!-- 관리자 권한 패스워드 설정 -->
        <enable xmlns="urn:ios">
          <password>
            <secret>12345678</secret>                    <!-- Enable 패스워드: 12345678 -->
          </password>
          <secret>
            <type>5</type>                              <!-- 암호화 타입: MD5 -->
            <secret>$1$8dga$xaXiEHsAP7p2QDiR0VAQr0</secret>  <!-- 암호화된 패스워드 -->
          </secret>
        </enable>
        
        <!-- 시간대 설정 -->
        <clock xmlns="urn:ios">
          <timezone>
            <zone>KST</zone>                            <!-- 시간대: 한국 표준시 -->
            <hours>9</hours>                            <!-- UTC+9시간 -->
            <minutes>0</minutes>                        <!-- 분 오프셋: 0분 -->
          </timezone>
        </clock>
        
        <!-- IP 관련 전역 설정 -->
        <ip xmlns="urn:ios">
          <cef-conf>
            <cef/>                                      <!-- CEF (Cisco Express Forwarding) 활성화 -->
          </cef-conf>
          <domain>
            <name>examdomain.com</name>                 <!-- 도메인 이름: examdomain.com -->
          </domain>
          <ssh>
            <version>2</version>                        <!-- SSH 버전: 2 (보안 강화) -->
          </ssh>
          <forward-protocol>
            <nd/>                                       <!-- Network Discovery 프로토콜 포워딩 -->
          </forward-protocol>
          <http>
            <server>false</server>                     <!-- HTTP 서버: 비활성화 (보안) -->
            <secure-server>false</secure-server>       <!-- HTTPS 서버: 비활성화 (보안) -->
          </http>
        </ip>
        
        <!-- 멀티링크 설정 (PPP 관련) -->
        <multilink xmlns="urn:ios">
          <bundle-name>authenticated</bundle-name>      <!-- 멀티링크 번들명: authenticated -->
        </multilink>
        
        <!-- 사용자 계정 설정 -->
        <username xmlns="urn:ios">
          <name>nso</name>                              <!-- 사용자명: nso -->
          <privilege>15</privilege>                     <!-- 권한 레벨: 15 (최고 관리자) -->
          <secret>
            <type>5</type>                              <!-- 패스워드 암호화: MD5 -->
            <secret>$1$ou/O$Fc2FfZtj0B5/97GkzArNj/</secret>  <!-- 암호화된 패스워드 -->
          </secret>
        </username>
        
        <!-- 하드웨어 이중화 설정 -->
        <redundancy xmlns="urn:ios"/>                   <!-- 이중화 기능 (기본 설정) -->
        
        <!-- ========================================
             네트워크 인터페이스 설정
             ======================================== -->
        <interface xmlns="urn:ios">
          <!-- Ethernet 0/0: 물리 인터페이스 (IP 주소 없음) -->
          <Ethernet>
            <name>0/0</name>                            <!-- 인터페이스명: Ethernet0/0 -->
            <ip>
              <no-address>
                <address>false</address>                <!-- IP 주소 설정 안함 -->
              </no-address>
            </ip>
          </Ethernet>
          
          <!-- Ethernet 0/0.100: VLAN 100 서브인터페이스 -->
          <Ethernet>
            <name>0/0.100</name>                        <!-- 서브인터페이스: Eth0/0.100 -->
            <encapsulation>
              <dot1Q>
                <vlan-id>100</vlan-id>                  <!-- VLAN ID: 100 -->
              </dot1Q>
            </encapsulation>
            <ip>
              <address>
                <primary>
                  <address>192.168.1.11</address>      <!-- IP 주소: 192.168.1.11 -->
                  <mask>255.255.255.0</mask>           <!-- 서브넷 마스크: /24 -->
                </primary>
              </address>
            </ip>
          </Ethernet>
          
          <!-- Ethernet 0/1: 고객 네트워크 연결 -->
          <Ethernet>
            <name>0/1</name>                            <!-- 인터페이스명: Ethernet0/1 -->
            <ip>
              <address>
                <primary>
                  <address>192.168.10.1</address>      <!-- IP 주소: 192.168.10.1 -->
                  <mask>255.255.255.0</mask>           <!-- 서브넷 마스크: /24 -->
                </primary>
              </address>
            </ip>
          </Ethernet>
          
          <!-- Ethernet 0/2: 관리용 인터페이스 -->
          <Ethernet>
            <name>0/2</name>                            <!-- 인터페이스명: Ethernet0/2 -->
            <ip>
              <address>
                <primary>
                  <address>172.16.1.41</address>       <!-- IP 주소: 172.16.1.41 -->
                  <mask>255.255.255.0</mask>           <!-- 서브넷 마스크: /24 -->
                </primary>
              </address>
            </ip>
          </Ethernet>
          
          <!-- Ethernet 0/3: 사용하지 않는 인터페이스 -->
          <Ethernet>
            <name>0/3</name>                            <!-- 인터페이스명: Ethernet0/3 -->
            <mop>
              <xenabled>false</xenabled>                <!-- MOP (Maintenance Over Protocol) 비활성화 -->
            </mop>
            <ip>
              <no-address>
                <address>false</address>                <!-- IP 주소 설정 안함 -->
              </no-address>
            </ip>
          </Ethernet>
        </interface>
        
        <!-- 시스템 제어 설정 -->
        <control-plane xmlns="urn:ios"/>                <!-- Control Plane 보호 (기본 설정) -->
        <config-register xmlns="urn:ios">0x0</config-register>  <!-- 부팅 설정 레지스터: 0x0 -->
        
        <!-- ========================================
             콘솔 및 원격 접속 설정
             ======================================== -->
        <line xmlns="urn:ios">
          <!-- 콘솔 포트 설정 -->
          <console>
            <first>0</first>                           <!-- 콘솔 라인 0 -->
            <logging>
              <synchronous/>                           <!-- 로그 출력 동기화 -->
            </logging>
          </console>
          
          <!-- AUX 포트 설정 -->
          <aux>
            <first>0</first>                           <!-- AUX 라인 0 -->
          </aux>
          
          <!-- VTY (가상 터미널) 설정 -->
          <vty>
            <first>0</first>                           <!-- VTY 라인 시작: 0 -->
            <last>4</last>                             <!-- VTY 라인 끝: 4 (총 5개 세션) -->
            <login>
              <local/>                                 <!-- 로컬 사용자 인증 사용 -->
            </login>
            <password>
              <secret>12345678</secret>                <!-- VTY 접속 패스워드 -->
            </password>
            <transport>
              <input>ssh</input>                       <!-- 접속 프로토콜: SSH만 허용 -->
            </transport>
          </vty>
        </line>
        
        <!-- ========================================
             로깅 설정
             ======================================== -->
        <logging xmlns="urn:ios">
          <buffered>
            <severity-level>debugging</severity-level>  <!-- 버퍼 로그 레벨: 디버깅 -->
          </buffered>
          <console>
            <severity-level>debugging</severity-level>  <!-- 콘솔 로그 레벨: 디버깅 -->
          </console>
          <monitor>
            <severity-level>debugging</severity-level>  <!-- 모니터 로그 레벨: 디버깅 -->
          </monitor>
        </logging>
        
        <!-- ========================================
             BGP 라우팅 프로토콜 설정
             - Provider 네트워크와 라우팅 정보 교환
             ======================================== -->
        <router xmlns="urn:ios">
          <bgp>
            <as-no>65001</as-no>                       <!-- 자율 시스템 번호: 65001 -->
            <bgp>
              <log-neighbor-changes>true</log-neighbor-changes>  <!-- BGP 이웃 변경사항 로그 -->
            </bgp>
            
            <!-- BGP 이웃 라우터 설정 -->
            <neighbor>
              <id>192.168.1.10</id>                    <!-- 이웃 라우터 IP: 192.168.1.10 -->
              <remote-as>65000</remote-as>             <!-- 원격 AS 번호: 65000 (Provider AS) -->
            </neighbor>
            
            <!-- 주소 패밀리 설정 -->
            <address-family>
              <!-- IPv4 유니캐스트 설정 -->
              <ipv4>
                <af>unicast</af>                       <!-- 주소 패밀리: IPv4 유니캐스트 -->
                <network-address>
                  <network>
                    <number>192.168.10.0</number>      <!-- 광고할 네트워크: 192.168.10.0/24 -->
                  </network>
                </network-address>
                <neighbor>
                  <id>192.168.1.10</id>                <!-- 이웃에서 활성화 -->
                  <activate/>
                </neighbor>
              </ipv4>
              
              <!-- VPNv4 설정 (MPLS VPN용) -->
              <vpnv4>
                <af>unicast</af>                       <!-- VPNv4 유니캐스트 -->
              </vpnv4>
            </address-family>
          </bgp>
        </router>
      </config>
    </device>
  </devices>
</config>
